#pragma once
#include "lib/NN.hpp"
#include "lib/utils.hpp"

#define INPUT_SIZE 3
#define HIDDEN_SIZE 32
#define OUTPUT_SIZE 2
#define STEPS 2

/* Data for normalization */
const float in_min[3] = {2.9700, 2.9700, 21.5000};
const float in_max[3] = {26.7300, 26.7300, 34.0000};
const float out_min[2] = {2.9700, 2.9700};
const float out_max[2] = {26.7300, 26.7300};

/* Weights and biases for each layer of the network */

// Layer 1 (RNN): INPUT_SIZE -> HIDDEN_SIZE
const float layer1_weights_ih[HIDDEN_SIZE * INPUT_SIZE] PROGMEM = {0.199174, 0.168217, -0.035685,
  0.192786, -0.062002, -0.007228, -0.026601, 0.198541, 0.059586, -0.124458, 0.203081, -0.030850,
  0.062682, -0.136599, -0.198775, -0.021989, 0.287026, -0.060873, -0.186814, -0.091761, -0.047658,
  -0.017086, 0.182373, 0.166184, -0.169878, -0.186449, -0.009439, -0.146480, -0.008111, -0.085694,
  0.166385, -0.004780, 0.136100, 0.040768, -0.170988, 0.054182, 0.034660, 0.256439, -0.016228,
  -0.082625, -0.105125, -0.045193, 0.080247, 0.248371, 0.019519, -0.078189, 0.214687, 0.008716,
  0.006670, -0.261770, -0.163524, -0.090547, 0.020503, 0.140179, 0.015394, 0.007717, 0.028231,
  -0.011289, 0.135891, -0.174439, -0.033641, -0.271425, -0.018061, -0.116862, -0.015841, -0.047507,
  0.144526, -0.232692, -0.088392, -0.158129, 0.201491, 0.013800, 0.241363, -0.175728, -0.034805,
  -0.220295, -0.218719, 0.062867, 0.092530, 0.230297, -0.143178, -0.177225, 0.048612, -0.064122,
  0.086515, -0.253826, -0.022358, -0.091205, 0.026650, -0.024720, 0.020239, 0.059702, 0.064211,
  0.059221, -0.171908, -0.033384};
const float layer1_weights_hh[HIDDEN_SIZE * HIDDEN_SIZE] PROGMEM = {0.199466, -0.032640, -0.051490,
  -0.371378, -0.078221, 0.054709, -0.105136, -0.134119, -0.036160, -0.142717, -0.046547, -0.083263,
  -0.146206, -0.142501, 0.232702, 0.010533, 0.105921, -0.178950, -0.090846, -0.103667, 0.040341,
  -0.187130, -0.047009, -0.155367, 0.030918, -0.122520, -0.012161, -0.178197, -0.029627, -0.143739,
  -0.031019, 0.020404, 0.162535, -0.026791, 0.070794, -0.185663, -0.127154, 0.119687, -0.067172,
  -0.068920, -0.150825, -0.168972, 0.114967, -0.032289, 0.055877, -0.169371, 0.128028, -0.152032,
  0.016092, 0.023042, 0.105631, 0.178066, 0.299247, -0.127852, 0.118659, -0.090415, 0.023521,
  -0.161096, 0.241825, -0.157214, 0.121147, 0.008237, 0.038696, 0.055697, 0.204838, 0.047711,
  -0.018192, -0.165489, 0.112120, -0.017249, -0.021634, 0.115519, 0.029920, -0.102274, -0.157224,
  0.016007, 0.090640, 0.014496, -0.077810, -0.101787, -0.092657, -0.028433, 0.186205, -0.139379,
  0.002588, 0.113067, 0.116349, -0.141206, 0.114236, 0.037696, 0.100742, 0.000315, -0.003558,
  -0.043029, -0.078583, -0.058324, 0.121209, 0.137807, -0.083155, -0.072642, -0.026141, 0.043722,
  0.053947, 0.028313, -0.178010, -0.053342, 0.136277, 0.016938, 0.009277, -0.024606, -0.150431,
  -0.122792, 0.042878, 0.010414, 0.113442, 0.086927, -0.150110, -0.086910, -0.108678, 0.191482,
  -0.014332, -0.077006, 0.044385, 0.021313, -0.156541, 0.082277, -0.044704, 0.052778, -0.178648,
  0.143469, 0.067482, -0.048081, -0.178156, -0.240580, -0.095427, 0.093411, 0.093900, 0.145478,
  0.127158, -0.013926, -0.033474, -0.171768, -0.222469, -0.245539, 0.114892, -0.119286, -0.033081,
  -0.035932, 0.108065, -0.194392, -0.015688, -0.160835, 0.024507, 0.114637, -0.093904, -0.080980,
  -0.039229, -0.325261, -0.035413, -0.083145, 0.081230, -0.152025, 0.091560, 0.196885, 0.136094,
  -0.147118, 0.124572, -0.055328, 0.087159, 0.187861, -0.065980, 0.031645, -0.058817, -0.156099,
  0.090193, -0.170833, 0.081985, 0.157645, 0.152482, -0.117495, -0.243326, 0.027215, 0.074114,
  -0.143221, -0.088450, -0.089654, -0.037751, -0.078871, -0.118460, -0.007642, -0.194751, 0.003554,
  0.151281, -0.005119, 0.056960, -0.177421, -0.169734, -0.100871, -0.068462, -0.111925, -0.135904,
  -0.034915, 0.021683, -0.095566, 0.033639, -0.053644, -0.025933, -0.069149, -0.140050, 0.159268,
  -0.067981, 0.085042, 0.036675, 0.008173, 0.092606, 0.054213, -0.149935, 0.075663, 0.176296,
  0.013905, 0.215971, 0.117386, 0.015070, 0.128645, -0.112281, -0.099561, 0.252731, 0.269661,
  -0.081640, 0.277938, -0.219539, -0.115864, -0.139450, 0.000007, 0.179971, 0.023227, -0.075914,
  -0.223620, 0.193702, 0.070909, -0.213622, 0.115801, -0.109045, 0.075465, -0.053258, -0.085019,
  -0.166112, -0.029528, -0.261169, -0.119202, 0.644757, -0.066433, -0.198799, 0.158979, 0.026269,
  -0.145876, 0.140645, 0.122059, -0.185990, 0.032484, 0.025608, -0.069484, -0.064673, 0.152828,
  -0.086273, -0.127132, -0.168860, -0.047439, 0.119840, -0.023076, -0.026107, -0.168471, -0.174597,
  0.013178, 0.154960, 0.147214, -0.076274, -0.070882, -0.148250, -0.109748, 0.089931, 0.103526,
  0.085593, -0.107432, -0.025166, -0.079044, 0.113560, 0.128840, -0.027872, 0.136832, -0.086034,
  0.120308, 0.090442, -0.036614, 0.041586, -0.062677, 0.150202, 0.102284, -0.037963, -0.088059,
  -0.161348, 0.058948, 0.029741, -0.063112, -0.109887, 0.135802, -0.012400, 0.006329, -0.125783,
  -0.142299, -0.209920, -0.087688, -0.133405, 0.095200, -0.084094, -0.027482, 0.134110, 0.106264,
  0.099784, -0.194273, -0.023580, 0.028355, -0.075209, -0.068132, 0.072872, -0.020207, -0.148845,
  0.149500, 0.145768, 0.050916, -0.092299, -0.081598, -0.076554, 0.082312, 0.163458, 0.028013,
  -0.121744, 0.108185, -0.126664, 0.028564, -0.164965, 0.020794, 0.003572, 0.056647, -0.105996,
  0.058440, 0.099748, 0.086204, 0.239975, -0.030170, -0.200875, 0.037922, 0.136253, -0.121392,
  -0.030106, -0.222893, -0.188847, 0.031719, 0.053488, 0.011303, -0.052512, 0.168589, 0.085389,
  -0.172144, 0.028638, -0.019411, 0.024514, -0.141268, 0.072780, -0.110254, -0.154331, -0.010698,
  0.237250, 0.107510, 0.148531, 0.071305, 0.180435, -0.029216, -0.086878, 0.130177, -0.171048,
  -0.174020, -0.017300, 0.039141, 0.060008, -0.126547, -0.109711, 0.122372, -0.098406, -0.074791,
  0.136438, -0.041247, 0.201134, 0.218273, -0.051342, 0.069083, 0.005290, 0.122834, -0.013747,
  0.012694, 0.111095, 0.124614, -0.044137, -0.092607, -0.106990, -0.008703, 0.024482, 0.206719,
  0.076449, 0.102445, -0.100297, -0.038158, -0.031313, -0.044494, -0.041057, -0.180695, 0.016036,
  -0.157962, -0.127353, -0.116889, 0.143565, -0.206381, 0.162253, 0.014469, 0.013692, 0.132906,
  -0.046766, 0.110370, 0.122977, -0.209641, 0.004305, 0.032160, -0.023745, 0.058419, 0.014683,
  -0.068122, 0.001093, 0.136871, 0.101695, 0.022990, -0.132442, 0.065107, -0.130704, 0.151389,
  -0.206889, 0.018579, -0.056109, -0.090668, 0.137732, -0.038937, 0.033735, 0.100586, 0.240689,
  -0.050597, 0.028041, 0.124670, 0.008941, 0.135380, -0.129733, -0.040356, 0.004069, 0.108406,
  0.091174, 0.087539, 0.173112, 0.121071, 0.009220, -0.140996, -0.086555, -0.048979, -0.051014,
  -0.140128, -0.166356, -0.134838, -0.043113, -0.170559, 0.029565, -0.029238, 0.047048, -0.059672,
  -0.056249, 0.078918, -0.143282, 0.079422, 0.068880, -0.181578, 0.228878, 0.133009, 0.040969,
  0.055336, -0.251086, -0.027099, 0.009709, 0.094815, -0.077937, 0.130326, -0.046369, -0.042125,
  -0.072619, -0.117071, -0.121331, -0.141150, 0.089807, 0.064187, -0.115134, 0.098067, -0.199948,
  0.058355, -0.124003, -0.126046, -0.123000, -0.199689, 0.096746, 0.173732, 0.173230, -0.095549,
  -0.177911, 0.117808, -0.029492, 0.001165, 0.039758, -0.122221, -0.017797, 0.134200, -0.051602,
  -0.069588, -0.145904, -0.017419, -0.085292, -0.030086, -0.085977, 0.033520, -0.191090, 0.031974,
  -0.183197, -0.058499, 0.093886, 0.173906, -0.087706, -0.130561, -0.276850, 0.066008, -0.126315,
  -0.037170, 0.043223, -0.167660, 0.020817, 0.158882, -0.202396, -0.251202, 0.258749, -0.079311,
  0.003893, -0.062218, 0.005028, -0.101086, 0.124120, 0.089139, -0.082600, 0.017074, 0.026732,
  -0.186899, -0.021242, 0.225474, -0.172613, 0.106460, -0.048373, -0.001212, 0.199018, -0.009454,
  0.090722, 0.088186, -0.051202, -0.114483, -0.087062, 0.083708, 0.193224, 0.112746, -0.109538,
  0.077154, -0.068049, -0.033205, -0.216865, -0.040943, 0.091527, 0.011018, 0.024881, 0.021223,
  -0.021495, 0.107273, -0.128074, -0.027321, -0.179409, -0.060420, 0.057372, 0.162594, 0.006654,
  0.150620, 0.087686, 0.092743, 0.170955, 0.118345, -0.088463, 0.135066, 0.049224, -0.057593,
  -0.032908, -0.078327, -0.020731, -0.180813, 0.017381, 0.011190, -0.164153, 0.019859, 0.024515,
  0.102484, 0.159334, -0.114962, 0.128733, 0.153365, 0.012763, -0.097714, -0.127966, -0.055902,
  0.007432, 0.125651, 0.009801, 0.066264, 0.018795, 0.082502, 0.035374, -0.117905, -0.174029,
  -0.024036, 0.064989, -0.152698, -0.202776, 0.196706, 0.088885, 0.132508, -0.160601, -0.156671,
  -0.016669, 0.309730, 0.090939, -0.048660, 0.209799, 0.163976, -0.067045, -0.043458, -0.011409,
  -0.127365, -0.131470, 0.201888, -0.089077, -0.011798, -0.077466, -0.024683, 0.132044, -0.023803,
  -0.042927, 0.143537, -0.060200, 0.172812, -0.005738, -0.020307, 0.002314, -0.038507, -0.295541,
  0.119636, -0.017232, -0.259776, -0.164359, 0.129042, 0.108242, 0.127930, -0.121040, -0.069283,
  -0.017928, 0.001276, -0.098476, 0.051812, 0.003795, -0.020922, 0.015071, -0.031404, 0.034854,
  0.109891, -0.088666, -0.112405, 0.046182, -0.050355, -0.123567, 0.178114, -0.144220, 0.166458,
  0.008237, -0.099145, 0.038526, -0.156670, -0.184107, 0.091171, -0.102212, 0.149680, -0.078024,
  0.051620, -0.115429, 0.055041, -0.053975, -0.138219, -0.038217, 0.166276, 0.165351, -0.085674,
  -0.020569, 0.074492, 0.051519, -0.056058, 0.114327, -0.017590, 0.014401, 0.242086, -0.130775,
  0.086584, 0.108922, 0.099674, -0.148328, -0.093765, -0.024503, 0.058076, 0.083029, -0.163343,
  0.002753, 0.027279, 0.122563, -0.054794, -0.173927, -0.121740, -0.160152, 0.380450, -0.176191,
  -0.036063, 0.211004, -0.103045, 0.059015, -0.161074, -0.241831, -0.180908, -0.042407, -0.026747,
  -0.067267, -0.011558, 0.071337, 0.160462, 0.056029, -0.077484, -0.302956, 0.083516, -0.175293,
  0.182958, 0.049271, 0.087062, 0.070974, 0.271603, -0.135921, -0.050631, 0.159095, -0.255491,
  -0.017627, 0.190671, 0.221212, -0.030124, 0.129876, -0.052602, -0.245084, 0.211632, -0.014955,
  -0.037754, 0.155527, 0.008129, 0.149095, -0.138586, 0.273830, 0.037672, -0.004415, 0.115714,
  0.072909, 0.026514, 0.112366, 0.011524, 0.068313, -0.002916, -0.191044, -0.032040, 0.032673,
  -0.217342, 0.179592, -0.105881, 0.167774, 0.011905, -0.113691, -0.120345, -0.023115, 0.121801,
  0.145995, 0.095161, 0.189190, 0.032559, 0.077106, 0.103915, -0.231267, 0.013385, 0.003483,
  -0.130997, -0.183537, 0.199216, 0.046968, 0.128451, 0.117687, -0.049859, -0.106090, 0.080640,
  -0.107489, 0.074834, -0.153469, 0.109974, -0.086171, 0.034092, 0.000337, 0.023828, -0.079990,
  -0.107174, -0.072107, -0.022466, 0.095995, -0.128588, -0.108440, -0.177088, -0.029053, -0.051452,
  -0.079850, 0.077386, 0.029845, -0.006463, -0.165989, -0.077301, -0.090073, -0.072397, -0.171231,
  0.071751, -0.140782, -0.226482, -0.107548, 0.044568, -0.015130, -0.096076, 0.138893, 0.101944,
  0.018578, -0.202014, -0.145921, 0.021137, 0.124490, -0.049023, -0.189805, -0.042384, -0.081219,
  0.143676, -0.089590, 0.188416, 0.113140, -0.033708, 0.062038, -0.025182, -0.021512, 0.052274,
  0.041017, 0.004153, 0.122632, 0.033127, -0.042302, 0.116291, 0.133195, 0.146840, -0.015874,
  0.002155, -0.028275, 0.259778, -0.277271, 0.047480, -0.172502, 0.099045, 0.007544, 0.003888,
  -0.005436, 0.009414, -0.059840, -0.182845, 0.100315, 0.079280, -0.032276, -0.031033, 0.078312,
  -0.152186, 0.114873, -0.041552, -0.173343, 0.041452, -0.099120, -0.089972, -0.168191, -0.082437,
  -0.122446, -0.036109, 0.007127, -0.104287, -0.137846, 0.007668, 0.008391, 0.127109, -0.074073,
  0.083107, 0.126979, 0.138167, -0.308187, -0.024155, -0.190887, -0.259794, 0.137098, -0.044289,
  0.080288, -0.116859, 0.113848, -0.022067, 0.032415, -0.107315, -0.057337, -0.148861, 0.042597,
  0.169914, 0.089069, -0.053558, 0.072863, -0.026243, -0.148504, 0.061297, 0.062293, 0.046253,
  -0.059668, -0.078236, 0.070330, 0.065822, -0.027362, -0.147040, 0.240211, -0.013686, 0.053900,
  -0.288953, 0.156691, 0.020950, -0.014671, -0.113142, -0.061398, -0.151346, -0.049672, 0.108139,
  0.147947, 0.215848, -0.091726, 0.137205, -0.205380, 0.204476, 0.046988, 0.261713, 0.176997,
  0.116889, -0.001723, 0.102107, -0.079749, -0.006285, -0.112927, 0.079715, -0.051771, -0.046444,
  -0.118795, -0.099458, -0.015841, -0.227140, 0.125907, 0.148320, 0.047342, 0.107874, -0.105559,
  -0.186201, 0.069804, 0.198746, -0.159055, 0.077503, 0.181513, 0.004467, -0.078890, 0.151914,
  -0.022957, 0.102448, -0.129202, 0.132180, -0.153346, 0.175600, -0.087310, 0.096533, 0.031600,
  0.111996, -0.006760, 0.111041, -0.063175, -0.113634, -0.075490, 0.167748, -0.024966, 0.098060,
  -0.061165, 0.150352, 0.078130, -0.041735};
const float layer1_bias_ih[HIDDEN_SIZE] PROGMEM = {-0.080337, -0.136108, 0.039421, -0.168432,
  0.191079, -0.162356, 0.034391, 0.203926, 0.050777, 0.061262, -0.055548, 0.106311, 0.011388,
  -0.183686, 0.255406, -0.092340, 0.051146, 0.164702, -0.093641, -0.109021, 0.077537, -0.059573,
  0.035946, -0.231214, 0.002417, -0.080018, -0.078021, -0.191861, 0.121993, -0.044400, -0.036897,
  0.185810};
const float layer1_bias_hh[HIDDEN_SIZE] PROGMEM = {0.063344, 0.041145, -0.071027, -0.038064,
  0.216066, 0.128771, -0.182292, 0.189060, -0.024055, 0.086008, 0.251835, 0.086975, -0.096178,
  0.136292, -0.039162, -0.007152, -0.059873, -0.035853, 0.020867, -0.005102, 0.020863, -0.021968,
  0.169602, 0.019759, 0.096032, 0.069359, 0.145741, -0.038156, 0.042318, -0.042074, -0.041615,
  -0.096876};

// Layer 2 (Linear): INPUT_SIZE -> HIDDEN_SIZE
const float layer2_weights[HIDDEN_SIZE * HIDDEN_SIZE] PROGMEM = {0.045696, -0.056682, -0.069497,
  -0.066840, 0.003246, 0.127278, -0.092552, 0.116193, 0.064399, -0.138744, -0.112140, -0.232535,
  0.043310, -0.092800, -0.036044, -0.034598, -0.046557, -0.159701, -0.051353, 0.315193, -0.105947,
  -0.027251, 0.048856, 0.030663, 0.155593, 0.101121, 0.221989, 0.161692, 0.037880, 0.073706,
  -0.029860, 0.153215, 0.105874, -0.010419, 0.040411, -0.133357, -0.149826, 0.009886, 0.073691,
  -0.111508, 0.145781, -0.127843, 0.189790, 0.252800, -0.098485, -0.095085, 0.074575, 0.004936,
  0.060201, 0.043923, 0.100112, -0.100620, -0.057429, -0.069647, 0.128670, 0.021565, -0.008476,
  0.027259, 0.014479, -0.164371, 0.149785, -0.029397, -0.196915, 0.078532, -0.148520, -0.038384,
  0.006294, -0.170582, 0.024375, -0.034296, 0.016285, 0.210040, 0.053928, 0.149525, -0.030297,
  -0.060097, -0.056479, 0.179226, -0.112690, -0.088054, 0.120779, 0.144376, -0.106908, 0.040293,
  0.044397, -0.197890, 0.075703, -0.022524, -0.094035, 0.150392, -0.248548, 0.028128, 0.259963,
  0.165658, -0.038257, -0.012303, -0.167016, -0.098253, 0.040040, -0.074792, -0.088369, 0.161142,
  0.118540, -0.124781, 0.075311, 0.115232, 0.096911, 0.121494, 0.218261, -0.013449, 0.136324,
  0.192873, -0.210732, -0.119935, 0.011002, 0.039698, -0.041861, 0.048210, -0.056968, 0.131763,
  -0.166790, 0.134613, 0.136777, -0.100765, 0.024652, 0.046036, -0.004678, 0.095525, 0.026350,
  -0.088589, 0.179625, -0.049437, 0.008707, 0.057927, -0.090062, 0.061451, -0.098277, 0.060076,
  -0.096800, 0.066835, -0.136481, -0.111289, 0.108104, 0.201051, -0.208546, 0.008904, -0.158289,
  -0.038928, 0.180624, 0.105788, -0.106012, 0.104344, 0.047874, 0.021330, 0.189778, -0.069411,
  -0.043447, -0.046316, -0.052691, -0.028305, 0.064706, -0.054702, -0.089050, 0.120733, -0.211014,
  -0.043965, -0.020654, -0.129633, -0.009171, -0.036688, 0.103795, -0.121744, 0.048793, 0.093596,
  -0.001499, -0.083709, -0.041782, 0.031068, -0.103028, 0.123847, 0.108423, -0.033576, -0.199382,
  -0.015521, 0.063094, 0.102089, 0.006024, 0.358740, -0.099512, -0.187568, 0.116134, -0.025216,
  0.259769, 0.093851, 0.085282, 0.145207, 0.057587, -0.227474, 0.142131, -0.219546, 0.073562,
  -0.097024, -0.115670, -0.023400, -0.027409, -0.239346, -0.039047, -0.057501, 0.203437, -0.104624,
  0.168450, 0.143999, -0.075927, 0.043774, -0.105246, -0.199089, 0.052544, -0.250595, -0.082835,
  0.131798, -0.208780, -0.098315, 0.029424, -0.027257, -0.139252, -0.029950, -0.014484, 0.051267,
  0.024133, -0.076579, -0.078821, 0.018893, -0.051640, 0.038790, -0.050438, 0.096585, 0.045959,
  0.158612, 0.001343, -0.125605, 0.062933, -0.110261, -0.019045, -0.084172, -0.012842, 0.026342,
  0.083862, 0.154388, -0.041747, 0.226163, -0.203581, 0.038083, 0.192386, 0.126113, -0.175865,
  0.001057, -0.031228, 0.065861, -0.025076, -0.092551, -0.197716, -0.142630, 0.068108, 0.035595,
  -0.231669, -0.130237, 0.035490, -0.198722, 0.118242, 0.109899, 0.089602, -0.165787, 0.071654,
  0.056574, 0.176398, -0.020903, -0.192751, 0.062100, 0.001365, -0.082899, 0.009680, -0.166668,
  0.148908, -0.033430, 0.055840, 0.101980, 0.072094, 0.012487, 0.019830, 0.160393, -0.182455,
  0.055547, -0.048924, 0.050544, 0.026432, -0.092732, -0.064299, 0.063310, -0.082603, -0.100818,
  -0.078179, -0.088268, 0.041769, 0.103027, 0.012304, 0.177239, -0.065126, -0.075545, -0.120741,
  -0.202076, -0.015827, -0.221202, -0.068530, 0.010105, 0.120303, 0.139374, 0.090848, -0.066363,
  0.063365, -0.024521, 0.093700, -0.150874, 0.035902, 0.013883, 0.011386, 0.044201, -0.083949,
  0.124149, 0.027375, 0.106997, 0.022187, 0.032198, 0.244020, 0.063428, 0.080239, -0.048031,
  0.156566, -0.017132, 0.108374, 0.171505, 0.013605, 0.003154, -0.091066, 0.047732, 0.059140,
  -0.082135, 0.144813, 0.106368, -0.171325, -0.034240, 0.054019, -0.099979, 0.064050, -0.019794,
  -0.111213, -0.019097, -0.121966, 0.144521, 0.027942, 0.116805, -0.017879, 0.005753, 0.091489,
  -0.074417, 0.052357, -0.143055, -0.047645, -0.030234, 0.137656, 0.065298, 0.194228, 0.133082,
  -0.071908, 0.026397, -0.230288, 0.011117, 0.005972, 0.067319, 0.159916, 0.181565, -0.066733,
  -0.128660, 0.065991, 0.013894, -0.061887, -0.013898, -0.069501, -0.074040, -0.103456, -0.180616,
  0.077506, -0.078032, -0.017416, 0.098143, 0.042006, -0.026299, -0.122608, -0.015290, -0.257250,
  -0.021749, 0.092006, 0.098319, 0.038224, 0.026778, 0.059718, 0.182141, -0.026567, 0.128676,
  0.001368, 0.026786, -0.001171, -0.027572, 0.055650, -0.181613, -0.116179, 0.235853, -0.097912,
  0.130182, -0.052666, 0.054888, 0.056440, 0.168970, -0.095350, 0.120975, -0.051420, 0.061229,
  0.023966, 0.055297, -0.027374, -0.163074, 0.286417, -0.091343, -0.135567, -0.048699, 0.167186,
  -0.022699, -0.142275, -0.037538, 0.058944, -0.125434, 0.300569, -0.119778, 0.130163, -0.230623,
  -0.079302, 0.160990, 0.183547, -0.198231, -0.037773, 0.058568, -0.120149, -0.134990, -0.116388,
  0.007229, 0.087620, 0.063205, 0.051615, 0.046751, -0.090430, 0.105304, -0.215872, -0.091469,
  0.211211, -0.155518, 0.006851, -0.157988, 0.001215, -0.091713, 0.041086, -0.258164, 0.214379,
  -0.233600, 0.191693, -0.129468, 0.078503, -0.164561, 0.046441, -0.032276, 0.035285, 0.025620,
  -0.099972, 0.047596, -0.194960, 0.140301, -0.069928, -0.010156, -0.138563, -0.019918, -0.184926,
  0.063608, 0.109410, 0.004721, 0.143229, -0.176001, 0.084423, -0.070004, 0.022715, -0.044222,
  0.149988, 0.217952, -0.039268, 0.151168, -0.254034, 0.158524, -0.230706, -0.012193, -0.062994,
  0.118412, 0.077949, 0.104317, -0.049965, -0.041873, -0.005608, 0.041760, -0.057119, -0.104176,
  -0.057677, 0.102268, 0.189150, -0.050827, 0.161701, 0.111966, 0.135486, 0.090905, -0.184904,
  0.170237, 0.115373, 0.173449, -0.080122, -0.010035, 0.101342, -0.116320, 0.021112, -0.144471,
  0.270366, -0.199509, 0.108214, 0.140579, -0.133232, -0.313413, -0.038818, 0.105079, 0.045300,
  -0.062779, -0.017717, -0.145446, -0.129474, 0.124970, 0.037278, -0.065408, 0.071484, 0.045458,
  0.076660, -0.019434, -0.138609, 0.138133, -0.013484, 0.051170, -0.140252, 0.095949, 0.176610,
  0.088351, 0.027104, 0.120816, -0.032342, 0.094943, 0.174761, 0.184165, -0.076585, 0.223598,
  0.023980, 0.012119, 0.158911, -0.078833, 0.075849, 0.202394, -0.145118, -0.147507, -0.087624,
  0.012808, -0.110292, -0.015028, 0.059764, 0.179625, 0.101436, 0.132332, -0.002297, -0.090462,
  -0.070043, 0.038684, 0.235973, 0.067018, -0.092744, -0.159318, -0.117466, -0.179233, 0.167378,
  -0.010660, -0.220927, 0.062675, 0.009041, -0.007869, 0.095723, 0.105064, -0.180873, -0.039198,
  -0.052020, -0.257820, -0.108552, 0.218685, -0.065291, -0.067925, -0.107900, -0.176485, 0.128958,
  -0.098168, -0.170677, -0.192520, 0.144920, -0.093099, 0.020192, -0.084477, -0.083403, -0.003513,
  0.200418, -0.088479, 0.053230, -0.034343, -0.124601, 0.151924, 0.026006, 0.193578, 0.001178,
  -0.138203, -0.099013, 0.290657, -0.203132, 0.039154, 0.097697, 0.080759, 0.089561, -0.081339,
  0.171083, -0.108850, -0.024339, 0.177891, 0.058053, 0.021068, -0.053446, -0.078532, 0.039510,
  0.000276, 0.114298, 0.064077, 0.181698, -0.045249, -0.123086, 0.061901, 0.077014, -0.102990,
  -0.173826, 0.103476, 0.083451, 0.049322, 0.136810, -0.136014, 0.134709, -0.084758, 0.041314,
  0.208653, 0.009905, 0.053865, -0.165446, -0.188784, -0.231081, 0.018734, 0.066579, -0.199300,
  0.128976, 0.159781, -0.111650, 0.158223, 0.007508, 0.098733, 0.056983, 0.158697, -0.002359,
  0.104161, 0.133018, -0.029183, -0.174590, -0.042476, -0.147528, 0.010305, 0.095242, -0.160662,
  -0.018499, -0.035830, 0.065022, -0.072322, 0.104894, -0.083428, -0.078711, -0.008061, 0.147361,
  -0.029232, 0.143639, 0.171378, -0.123013, 0.005820, -0.038168, -0.103047, 0.056800, -0.066186,
  0.134771, -0.070149, 0.073354, -0.163987, -0.043074, 0.023307, 0.122644, 0.111489, -0.119218,
  0.036476, -0.110081, -0.057558, -0.138775, -0.061626, 0.139532, -0.215226, -0.159336, 0.016486,
  -0.003597, -0.013516, 0.161612, -0.129721, -0.161899, -0.164825, 0.001335, 0.006908, -0.146052,
  -0.108139, 0.091983, -0.107283, 0.102945, 0.176990, -0.154322, -0.095132, -0.111206, -0.055017,
  -0.199953, -0.077777, 0.193087, -0.076763, 0.079907, -0.076098, 0.084917, 0.004116, 0.045100,
  0.105664, 0.015226, 0.133978, -0.234942, -0.007349, 0.016707, -0.019790, -0.112563, 0.035554,
  -0.105238, -0.075199, -0.070125, 0.074312, -0.194688, 0.029278, 0.112104, 0.045193, 0.015973,
  0.078161, -0.053035, -0.065906, -0.008167, -0.113846, -0.184439, 0.242280, -0.014926, 0.177557,
  0.057821, -0.025978, -0.093865, -0.160317, -0.098239, 0.204016, -0.202614, 0.004461, 0.107167,
  0.278126, -0.036298, 0.094264, 0.104251, 0.176457, 0.089215, -0.007524, -0.186792, -0.061157,
  -0.068130, -0.029705, -0.021604, 0.043737, 0.106830, -0.108729, -0.088816, -0.099604, -0.174158,
  0.058032, -0.108549, -0.065376, -0.005875, -0.135956, 0.095958, -0.027446, -0.041442, -0.159454,
  0.017778, -0.059957, 0.054414, -0.092546, 0.029638, -0.175937, -0.105293, -0.167346, 0.029725,
  -0.097259, 0.245797, -0.015307, -0.021447, 0.112884, -0.044552, 0.001012, 0.073690, -0.188856,
  -0.045933, -0.066622, -0.162234, -0.182528, 0.179645, -0.014523, 0.187572, 0.088562, -0.080267,
  -0.015607, 0.039692, -0.036780, -0.053203, -0.091377, -0.031233, 0.270520, -0.123491, -0.236658,
  -0.120330, 0.121892, -0.008089, -0.004523, 0.099621, 0.065325, 0.017755, -0.022397, 0.049507,
  0.086393, 0.128224, -0.110097, -0.067403, 0.077347, 0.158650, 0.139881, -0.166119, -0.087905,
  -0.152100, 0.035265, 0.112237, 0.006301, 0.055264, 0.058427, 0.070823, -0.201038, 0.129272,
  -0.055073, 0.012747, -0.005052, -0.200300, 0.207150, 0.017319, -0.156143, 0.167026, 0.122878,
  -0.008248, 0.104836, -0.198258, 0.054912, -0.059306, -0.082850, 0.041313, 0.146713, -0.063125,
  -0.082353, 0.172413, -0.034937, 0.010980, 0.012252, 0.017399, 0.154314, -0.162573, -0.059646,
  0.065125, -0.015516, -0.039877, -0.202475, 0.152873, 0.031699, 0.000657, -0.062462, -0.065502,
  0.167401, -0.022763, 0.192534, 0.012297, 0.037493, 0.047537, 0.001925, -0.034137, 0.038194,
  0.170265, 0.078553, 0.119596, 0.142320, 0.064846, 0.066829, 0.027262, 0.034555, 0.075558,
  0.128633, 0.180039, -0.001081, 0.140482, -0.114660, 0.117590, 0.056604, 0.108326, -0.026467,
  -0.142614, 0.248842, -0.127702, 0.098253, 0.086688, -0.174200, 0.040337, -0.015512, 0.065958,
  -0.048484, 0.063056, 0.041429, 0.124488, 0.203608, 0.019699, -0.181139, 0.102650, -0.000627,
  0.014660, -0.168516, -0.059742, -0.088461, 0.245933, 0.120226, 0.134422, 0.079725, -0.059265,
  -0.087897, -0.083787, -0.060113, 0.111975, 0.107412, 0.098667, -0.074073, -0.072955, -0.157873,
  0.193172, 0.078717, 0.057554, 0.006636, -0.201168, -0.104534, 0.157911, -0.005974, 0.123576,
  0.101039, -0.112696, 0.098913, -0.084469, -0.037948, -0.075028, -0.200772, 0.007565, 0.004074,
  -0.026180, 0.102193, -0.212057, -0.209123, -0.095570, -0.104586, 0.014780, -0.034793, 0.108424,
  -0.110734, -0.013313, -0.068654, 0.114401, 0.111293, 0.173108, -0.131623, -0.157117, -0.065431,
  -0.106881, -0.000108, 0.052384, 0.186137};
const float layer2_bias[HIDDEN_SIZE] PROGMEM = {0.045971, -0.034262, 0.062656, 0.109888, 0.042718,
  0.099302, -0.243370, 0.124479, -0.185531, -0.203204, -0.052478, 0.045744, 0.095800, 0.053688,
  -0.020759, -0.056677, -0.044307, 0.018283, 0.049938, 0.072523, 0.158516, -0.106793, -0.018679,
  -0.115140, -0.010627, -0.199421, -0.016084, -0.064458, 0.227318, 0.164705, -0.162477, -0.229296};

// Layer 3 (Linear): HIDDEN_SIZE -> HIDDEN_SIZE
const float layer3_weights[HIDDEN_SIZE * HIDDEN_SIZE] PROGMEM = {0.091918, -0.103628, 0.011518,
  -0.073119, 0.117704, -0.088552, -0.150340, -0.069715, 0.039480, -0.047787, -0.083864, -0.023400,
  -0.078128, -0.116698, -0.074991, 0.146387, -0.100669, -0.081842, 0.048582, -0.162932, -0.063806,
  -0.001240, 0.125810, -0.100905, 0.108773, -0.123115, 0.054150, -0.270512, 0.175037, 0.219855,
  -0.072549, 0.047449, 0.090636, 0.106377, 0.100922, -0.206098, -0.187396, -0.182469, 0.111644,
  -0.187937, -0.088012, -0.046436, -0.205567, -0.036016, -0.033640, -0.083729, 0.191047, -0.117869,
  -0.012627, 0.113125, 0.114615, -0.000645, -0.136501, -0.113762, 0.060873, 0.071546, 0.045832,
  -0.039041, -0.225808, -0.092376, -0.098517, -0.026645, -0.021777, -0.079752, 0.089528, -0.170819,
  -0.197694, -0.118790, -0.001727, 0.189171, 0.026885, -0.029266, 0.006470, 0.054469, 0.064379,
  -0.126911, -0.122082, -0.066989, -0.056890, -0.095947, -0.084344, -0.087934, 0.213938, 0.131785,
  0.151274, 0.016198, -0.076654, -0.038907, -0.120935, -0.114711, 0.058631, -0.141503, -0.156283,
  0.108272, 0.093690, -0.152022, 0.013120, -0.021481, 0.091216, 0.043868, 0.072331, 0.066628,
  -0.164866, 0.050012, 0.028444, 0.003139, -0.076674, -0.019616, 0.034765, -0.133560, -0.117023,
  -0.025927, 0.066341, 0.222946, -0.029734, 0.006456, 0.069212, 0.117571, -0.060346, 0.161320,
  0.013477, -0.168778, -0.052834, -0.000514, 0.253622, 0.140748, -0.013345, 0.117365, -0.093114,
  0.116610, 0.217129, 0.053807, -0.152653, 0.031745, -0.124929, 0.085809, -0.225353, -0.028609,
  -0.077633, -0.040045, -0.021334, -0.049469, -0.244198, -0.077768, -0.013613, 0.208266, 0.205504,
  -0.158801, 0.078701, -0.081457, -0.184972, 0.056009, -0.088858, -0.213268, -0.090965, -0.113479,
  0.212288, 0.122815, -0.147336, -0.191809, -0.165632, -0.102139, -0.023780, 0.136011, 0.006104,
  -0.013489, 0.073032, -0.032644, -0.190324, -0.000056, -0.133835, 0.059951, 0.260209, -0.153753,
  -0.206128, 0.096026, -0.201324, 0.191286, -0.076435, 0.083486, -0.180152, -0.108212, -0.022604,
  0.188279, 0.205419, 0.123611, 0.021639, -0.026111, 0.083658, -0.049519, -0.043325, -0.209974,
  -0.224754, 0.201247, -0.095643, 0.068846, -0.054486, -0.041172, 0.246146, -0.125056, 0.034491,
  0.093423, -0.072855, -0.237663, 0.113199, -0.167130, 0.112727, 0.067392, 0.030102, 0.014666,
  -0.093567, 0.188795, 0.035274, 0.009979, -0.077646, -0.049637, 0.124099, 0.206581, 0.029839,
  -0.057636, 0.092469, -0.089920, 0.214767, 0.242776, 0.077954, -0.134651, 0.158503, -0.026633,
  0.156942, -0.058032, -0.133054, -0.110910, -0.140061, 0.013468, -0.076102, -0.093573, 0.177651,
  0.103502, -0.116692, -0.043561, -0.130931, -0.036603, 0.163611, -0.084849, -0.021851, -0.125595,
  -0.103266, 0.112027, 0.183964, -0.044132, 0.034285, 0.100233, 0.073394, -0.020948, -0.143732,
  -0.103497, 0.159111, 0.005430, 0.101676, 0.045241, 0.203928, -0.015703, -0.150758, -0.037653,
  -0.220042, -0.165465, -0.079949, 0.041878, -0.007467, 0.010120, -0.193700, 0.218366, -0.107123,
  0.077924, 0.186667, -0.148057, 0.032632, 0.120952, 0.133298, -0.063188, 0.126285, -0.201805,
  -0.034659, 0.058351, 0.023469, 0.230646, -0.054041, -0.147990, 0.091319, 0.227716, 0.062932,
  -0.158791, -0.095102, -0.144479, 0.195289, 0.030336, 0.074972, 0.134174, -0.119608, -0.175825,
  0.279726, 0.013376, -0.017136, 0.057529, 0.096070, 0.026032, -0.208019, -0.001984, -0.253034,
  0.124345, 0.130201, 0.061971, 0.132104, 0.002863, -0.061724, -0.024478, -0.020797, 0.001128,
  0.154285, 0.071252, -0.057811, 0.125002, 0.219784, 0.056380, -0.189337, 0.069995, -0.046479,
  0.280861, -0.057759, -0.061102, -0.061402, 0.164082, 0.061056, 0.134031, 0.122335, -0.187497,
  0.055158, -0.078690, -0.158007, -0.004592, -0.003502, 0.037034, 0.058413, -0.016502, -0.165429,
  -0.041879, -0.031855, -0.042808, 0.272011, -0.083598, -0.138866, -0.023060, 0.187400, 0.050798,
  0.041579, 0.050739, 0.185238, 0.098554, 0.093081, -0.026922, -0.176350, -0.091610, 0.068669,
  -0.000476, -0.095246, 0.191129, 0.022855, 0.044407, 0.028707, -0.020399, 0.189800, -0.008445,
  0.144272, -0.149902, -0.127055, -0.075584, 0.112546, 0.055830, 0.108382, -0.250581, 0.024488,
  -0.088840, -0.189327, -0.024943, -0.030508, 0.126563, -0.039320, 0.068000, 0.054696, -0.088926,
  0.079855, 0.083164, 0.035862, 0.105065, -0.167504, -0.040148, 0.302562, 0.018674, 0.084463,
  0.042884, -0.052136, 0.088122, 0.109620, 0.039652, -0.108552, 0.111137, -0.239251, -0.003844,
  -0.064157, -0.048235, -0.118185, -0.012905, 0.105857, -0.110734, -0.130439, -0.174907, -0.022789,
  -0.064073, -0.084358, -0.118308, -0.066348, -0.106059, -0.056575, -0.224425, 0.108890, -0.038677,
  -0.097519, 0.136819, -0.011744, -0.118829, -0.122818, 0.218292, -0.239919, -0.106706, -0.179495,
  0.093806, -0.040780, -0.216745, 0.258271, -0.166644, 0.317534, -0.032681, 0.025667, 0.059304,
  -0.195881, 0.088694, -0.061057, 0.064774, -0.102805, 0.056786, 0.086991, 0.126581, 0.070684,
  -0.145243, 0.227043, -0.074611, 0.172605, -0.045902, -0.049504, -0.151399, 0.066295, 0.085315,
  -0.053135, 0.021012, -0.051765, -0.082106, 0.041037, -0.078623, 0.062119, -0.130616, 0.087768,
  -0.276409, -0.027831, 0.205243, 0.157676, 0.050942, 0.063903, 0.174154, 0.107801, 0.107154,
  0.027635, 0.154636, 0.235974, -0.051170, -0.084467, -0.063311, 0.012048, -0.062580, -0.008469,
  -0.110037, 0.012513, 0.032669, -0.013343, 0.075231, 0.090728, -0.148719, 0.223485, 0.218597,
  0.115830, -0.036970, 0.029482, -0.054252, -0.161940, 0.159336, -0.005865, 0.046375, -0.196948,
  0.150023, 0.028178, 0.148991, 0.098981, 0.020785, 0.113684, 0.164552, 0.097632, -0.130144,
  0.108631, -0.052032, 0.192040, -0.087299, 0.195433, 0.224575, -0.197153, 0.097891, -0.136221,
  -0.151148, -0.062981, 0.005445, -0.088235, -0.093071, -0.155646, 0.086445, -0.218754, -0.104685,
  0.037775, -0.006784, -0.100599, 0.139836, -0.180193, -0.083959, -0.081456, -0.155559, 0.193425,
  -0.032510, 0.024381, 0.057027, -0.188612, 0.160614, -0.047708, -0.027428, -0.148292, -0.071102,
  -0.091714, -0.167709, 0.107802, -0.006775, 0.150518, 0.141008, 0.100373, 0.110178, 0.061299,
  0.151462, 0.180414, -0.143065, -0.016809, -0.161849, -0.004024, -0.134014, 0.185584, -0.001354,
  0.081710, -0.196066, -0.122788, 0.052066, -0.131933, -0.128979, 0.089169, -0.078682, -0.037321,
  0.152585, 0.009501, -0.064413, 0.018731, 0.158761, -0.193092, 0.005136, -0.006636, 0.032285,
  0.267745, -0.171960, 0.057517, -0.065624, -0.162115, 0.180457, -0.085826, 0.011851, 0.054095,
  -0.143240, -0.198639, 0.163983, 0.186062, -0.029461, 0.129705, 0.053677, 0.101956, -0.125084,
  0.130468, 0.050937, -0.049501, 0.138911, -0.101278, 0.044611, -0.178953, 0.013334, 0.041031,
  0.155145, 0.030485, -0.155641, -0.215020, 0.048943, 0.060494, -0.218465, 0.158212, 0.033378,
  -0.168655, 0.143018, 0.065414, -0.030299, 0.003544, -0.127638, 0.034214, 0.268694, 0.180828,
  0.120080, -0.075242, 0.043700, 0.099588, -0.028467, -0.056660, 0.022664, -0.115997, -0.076203,
  -0.135401, -0.173982, -0.133915, 0.127314, 0.080412, -0.173208, -0.058268, 0.065364, -0.100083,
  -0.084123, -0.095688, -0.044396, 0.105463, -0.058180, 0.169119, 0.114367, 0.112325, 0.002133,
  -0.091826, -0.004982, -0.099539, 0.080649, -0.077632, -0.021814, -0.233649, 0.160850, 0.076469,
  0.137236, -0.009049, 0.103747, -0.112007, -0.049687, 0.002427, 0.061903, -0.161724, 0.074670,
  0.098554, 0.053725, 0.153228, 0.122941, -0.055091, -0.043000, -0.031954, -0.222928, 0.036849,
  -0.010868, 0.192032, 0.200447, -0.098863, -0.000927, -0.204588, 0.132853, -0.081351, 0.046925,
  0.221640, 0.089841, -0.212981, 0.026960, -0.126998, 0.078857, -0.098138, 0.207572, 0.182456,
  0.042717, -0.055455, 0.142321, 0.079578, 0.162783, 0.115699, -0.112131, 0.087255, 0.088398,
  -0.117915, 0.040484, -0.015051, -0.129562, -0.042742, 0.030055, -0.083651, -0.086497, 0.102292,
  0.174663, -0.042791, -0.096966, -0.033880, -0.177356, -0.124204, -0.066768, 0.183116, -0.201280,
  -0.008898, -0.087397, -0.195654, -0.075774, 0.004282, -0.067437, 0.133323, 0.126765, 0.141689,
  0.161599, -0.056840, 0.138217, -0.169293, 0.030871, 0.098952, -0.067369, 0.050162, -0.132265,
  -0.247335, 0.048256, -0.022122, -0.012819, 0.098972, -0.156129, -0.078921, 0.126436, -0.188497,
  0.084092, 0.184999, 0.069953, 0.135370, -0.212456, 0.065766, -0.024592, -0.115731, 0.061636,
  -0.097325, -0.095114, -0.224650, 0.049602, 0.073164, 0.131657, 0.106623, -0.278013, 0.141720,
  0.255722, 0.184610, 0.044632, -0.158077, -0.133317, 0.025549, -0.061663, -0.043556, -0.027836,
  0.032547, 0.062126, -0.129246, -0.119517, 0.264375, -0.013143, 0.205922, -0.036550, 0.174494,
  -0.013074, -0.164534, 0.008097, -0.008672, -0.009399, -0.123895, -0.027206, -0.157592, 0.058900,
  -0.087305, 0.107779, 0.167590, -0.085567, 0.017613, -0.095639, 0.147717, 0.115256, 0.001865,
  0.026547, -0.057759, 0.254106, -0.006383, -0.169950, -0.140298, 0.104371, 0.095633, 0.082889,
  0.035349, -0.021421, 0.115498, -0.066781, 0.146015, -0.123099, 0.058113, 0.093838, -0.108181,
  0.084681, -0.045168, 0.020230, 0.041074, -0.147237, -0.105707, 0.124251, -0.067284, 0.022544,
  -0.059287, -0.024126, -0.109709, -0.091101, 0.001777, -0.080128, 0.043666, 0.152194, 0.025230,
  0.150301, 0.099320, -0.088389, -0.104055, 0.156820, 0.033191, 0.144589, -0.178706, 0.086362,
  -0.172255, 0.082575, 0.120406, 0.044412, -0.219318, -0.101010, 0.187309, 0.049344, -0.117929,
  0.205784, 0.035802, -0.040875, -0.134910, 0.006505, -0.071139, 0.048503, 0.051658, 0.065739,
  -0.238437, 0.245630, -0.119561, -0.048887, -0.096869, -0.061511, 0.118814, -0.042550, 0.190292,
  -0.067436, -0.070592, -0.142681, 0.035067, 0.078795, 0.108124, 0.012533, 0.148064, -0.027214,
  -0.090955, -0.154093, 0.070409, -0.067215, 0.090059, 0.041522, -0.158089, -0.052615, -0.222543,
  -0.036004, 0.004781, -0.030086, 0.103271, -0.141000, 0.098775, -0.218396, -0.074752, 0.102472,
  -0.212002, 0.194611, -0.047108, 0.152839, -0.060378, 0.099617, 0.136772, 0.052087, 0.056306,
  0.063011, -0.091425, 0.080269, -0.070097, 0.160084, -0.168143, -0.117615, 0.121457, -0.101430,
  0.198515, 0.162978, 0.132822, -0.106149, -0.052255, 0.009467, -0.001849, -0.173879, 0.075962,
  0.046213, -0.018687, -0.181014, 0.012039, -0.021269, 0.088432, 0.070985, 0.082111, -0.034586,
  -0.037396, -0.060035, -0.190702, 0.177982, -0.066205, 0.065294, 0.008915, 0.106153, 0.199605,
  -0.099183, 0.081951, -0.046792, -0.067793, 0.018245, 0.070523, 0.210245, -0.123189, 0.242741,
  0.066525, 0.199842, 0.046131, -0.135167, 0.205630, 0.235502, -0.047213, -0.000593, 0.034013,
  0.225772, 0.039775, 0.122043, -0.039089, -0.054236, -0.032730, 0.089446, 0.023216, -0.163326,
  0.022428, -0.204647, -0.070421, 0.068089, -0.057879, 0.128444, -0.112018, -0.108140, 0.003966,
  0.094161, 0.057965, 0.215060, 0.089049, 0.216611, -0.246128, 0.012706, -0.218090, -0.108091,
  -0.049134, 0.048684, 0.226558, 0.069621, -0.202763, -0.117310, 0.118451, 0.146461, 0.102351,
  -0.124036, -0.013423, 0.074049, -0.174278, 0.184859, 0.088406, -0.167706, -0.020884, -0.025572,
  0.109414, -0.036239, 0.087118, -0.250184};
const float layer3_bias[HIDDEN_SIZE] PROGMEM = {-0.021941, -0.188636, 0.120041, 0.099445, 0.047837,
  0.228025, -0.257845, 0.164432, -0.011892, -0.131245, -0.107295, -0.064861, -0.133945, -0.000519,
  -0.146836, 0.161770, -0.201736, 0.026076, 0.083910, 0.186696, -0.120878, 0.041019, 0.109956,
  0.208721, 0.035021, 0.061818, 0.013184, 0.030322, 0.152994, 0.174703, 0.080396, 0.190620};

// Output layer: HIDDEN_SIZE -> OUTPUT_SIZE
const float output_weights[OUTPUT_SIZE * HIDDEN_SIZE] PROGMEM = {-0.000971, 0.110989, 0.055213,
  -0.154422, -0.134767, -0.244651, 0.101111, -0.147601, -0.031348, 0.024476, -0.017596, 0.066217,
  0.032768, -0.014467, 0.187226, -0.051335, 0.153990, -0.009437, -0.127157, -0.160048, 0.048533,
  -0.048462, -0.052186, -0.150407, 0.007291, -0.011488, -0.116996, 0.017460, -0.103114, -0.115371,
  -0.083540, -0.212002, 0.142866, -0.240294, 0.213014, -0.113313, -0.016096, -0.020969, -0.159021,
  0.092624, 0.119331, -0.164841, -0.202287, 0.098829, -0.217421, 0.152775, 0.057111, -0.158791,
  -0.154969, 0.121728, -0.100063, -0.160130, -0.166740, -0.055393, 0.359783, 0.082271, 0.194160,
  0.096378, -0.194696, 0.122742, 0.021822, -0.048204, 0.096607, -0.034645};
const float output_bias[OUTPUT_SIZE] PROGMEM = {-0.064042, -0.058540};

// Neural Network Function
void neural_network(const float input[INPUT_SIZE * STEPS], float output[OUTPUT_SIZE]) {
  float normalized_input[INPUT_SIZE * STEPS];
  copyArray(input, normalized_input, INPUT_SIZE * STEPS);

  float layer1_h_state[HIDDEN_SIZE] = {0, 0};

  float layer1_output[HIDDEN_SIZE];
  float layer2_output[HIDDEN_SIZE];
  float layer3_output[HIDDEN_SIZE];

  // Normalize input data
  NN::Normalize(normalized_input, INPUT_SIZE, in_min, in_max);
  NN::Normalize(&normalized_input[INPUT_SIZE], INPUT_SIZE, in_min, in_max);

  // Layer 1: Linear + Tanh
  for (int t = 0; t < STEPS; t++) {
    NN::RNN(&normalized_input[INPUT_SIZE * t], layer1_output, layer1_h_state, layer1_weights_ih,
      layer1_weights_hh, layer1_bias_ih, layer1_bias_hh, INPUT_SIZE, HIDDEN_SIZE);
    NN::Tanh(layer1_output, HIDDEN_SIZE);

    copyArray(layer1_output, layer1_h_state, HIDDEN_SIZE);
  }

  // Layer 2: Linear + Tanh
  NN::Linear(layer1_output, layer2_output, layer2_weights, layer2_bias, HIDDEN_SIZE, HIDDEN_SIZE);
  NN::Tanh(layer2_output, HIDDEN_SIZE);

  // Layer 3: Linear + Tanh
  NN::Linear(layer2_output, layer3_output, layer3_weights, layer3_bias, HIDDEN_SIZE, HIDDEN_SIZE);
  NN::Tanh(layer3_output, HIDDEN_SIZE);

  // Output layer: Linear
  NN::Linear(layer3_output, output, output_weights, output_bias, HIDDEN_SIZE, OUTPUT_SIZE);

  // Denormalize output
  NN::Denormalize(output, OUTPUT_SIZE, out_min, out_max);
}
